[
  {
    "__comment__": "(Required) Input folder and file name or file name pattern such as 'SWI_N_ALL_INV*.xlsx' (to process multiple files using the same configuration).",
    "input_folder_path": "./input/budget/",
    "input_file_name_or_pattern": "Global Budget Roll-up_9.16.19.xlsx",

    "__comment__": "(Optional) Enter sheet name to process from input Excel file. Default is the first sheet.",
    "sheet_name_of_input_excel_file": "Budget Roll-Up",

    "__comment__": "(Optional) Enter sheet name for the output Excel file. Default is 'Sheet1'.",
    "sheet_name_of_output_excel_file": "Sheet1",

    "__comment__": "(Optional) Boolean flag telling if we should write data to a destination place. Default is always True.",
    "write_output": true,

    "__comment__": "(Optional) Relative path (from folder in which transform.py resides) and file name of DataWriter class that has write_data method implemented.",
    "__comment__": "Default is DataWriter class (implemented in 'csv_data_writer.py') which writes transformed data to local file in CSV format.",
    "__comment__": "This option is only for those who wants to write data to somewhere other than to a local file in CSV format.",
    "data_writer_module_file": "./mssql_data_writer.py",

    "__comment__": "(Optional) Relative path of output folder if the data is going to be written to a file. Default is going to be the current working directory of transform.py",
    "__comment__": "Default is going to be the current working directory of transform.py",
    "output_folder_path": "./output/budget/",

    "__comment__": "(Optional) Prefix for the output file name.",
    "output_file_name_prefix": "transformed_budget_",

    "__comment__": "(Optional although recommended) SQL table name to which the transformed data should be written.",
    "__comment__": "Default name is 'default_transformed_sql_table_name' as defined in transform_utils.py",
    "output_sql_table_name": "transformed_budget_table",

    "__comment__": "(Required ONLY IF MSSQLDriver class is used) Database schema to use if we write transformed data to SQL table.",
    "database_schema": "dbo",

    "__comment__": "(Optional) Whether to include index column in writing the dataframe to output file or table. Default is false.",
    "include_index_column_in_output": false,

    "__comment__": "(Optional) Path+name of that has **CUSTOM** functions for data transformation, which will be imported and used in the transform process.",
    "custom_transform_functions_file": "./transform_functions/budget_transform_functions.py",

    "__comment__": "(Required if there's header row in your data) Enter the row index (>= 0) to extract column headers from. E.g., if column header row is the first row, enter 0 below.",
    "__comment__": "If this value is NOT provided, the program will assume there is no header row in the input file.",
    "header": 0,

    "__comment__": "(Optional) Specify the row index (>= 0) where the data, *not including the column headers*, begins.",
    "__comment__": "Default is 1 (the second row) because that's where the data usually begins in files (the first row is almost always the column headers).",
    "skiprows": 1,

    "__comment__": "(Optional) Specify the index (>=0) of rows we should ignore from the bottom of the data file.",
    "__comment__": "Default is 0, meaning there's no rows at the end to skip.",
    "skipfooter": 0,

    "__comment__": "(Required) List of the functions and their parameters.",
    "__comment__": "These functions must be defined either in transform_functions.py or individual task's transform file such as .\\transform_function\\switzerland_transform_functions.py",
    "functions_to_apply": [
      {
        "__function_comment__": "Budget roll up Excel file has empty columns. We need to drop them first",
        "function_name": "drop_unnamed_columns"
      },
      {
        "__function_comment__": "By the time we run this function, there should be only 13 columns total remaining in the raw data frame.",
        "function_name": "assert_number_of_columns_equals",
        "function_args": [13]
      },
      {
        "__function_comment__": "After all this, make sure we don't have any NULL values in Region, Hub, Market, Year, Category, Segment Macro, Brand, Macro Channel and Channel columns ",
        "function_name": "assert_no_na_values_in_columns",
        "function_args": [[
          "Region", "Hub", "Market", "Year",
          "Category", "Segment Macro", "Brand", "Macro Channel",
          "Channel"]]
      },
      {
        "__function_comment__": "Before mapping region names, let's capitalize all of region names",
        "function_name": "capitalize_all_letters_of_each_word_in_multiple_columns",
        "function_args": [["Region"]]
      },
      {
        "function_name": "update_str_values_in_column",
        "function_args": [
          "Region",
          {
            "LATAM": "Latin America",
            "EUROPE": "Europe",
            "APAC": "Asia-Pacific",
            "AED": "Africa-Eurasia",
            "NA": "North America"
          }
        ]
      },
      {
        "function_name": "capitalize_first_letter_of_each_word_in_multiple_columns",
        "function_args": [["Channel", "Macro Channel", "Segment Macro", "Market"]]
      },
      {
        "function_name": "update_str_values_in_column",
        "function_args": [
          "Channel",
          {
            "Youtube": "YouTube",
            "Ecommerce": "eCommerce",
            "E-Commerce": "eCommerce",
            "E-commerce": "eCommerce",
            "e-Commerce": "eCommerce",
            "e-commerce": "eCommerce",
            "ecommerce": "eCommerce"
          }
        ]
      },
      {
        "function_name": "update_str_values_in_column",
        "function_args": [
          "Segment Macro",
          {"HC": "HC Product Range", "PC": "PC Product Range"}
        ]
      },
      {
        "function_name": "update_str_values_in_column",
        "function_args": [
          "Market",
          {
            "USH": "US",
            "AA": "US"
          }
        ]
      },
      {
        "function_name": "update_int_values_in_multiple_columns_to_str_values",
        "function_args": [
          ["Year"],
          [
            {"2019": "2019LE"}
          ]
        ]
      },
      {
        "__function_comment__": "Whenever Channel is 'Ecommerce' or 'Amazon', set Macro Channel to 'eCommerce'.",
        "function_name": "update_str_values_in_col2_based_on_col1_values",
        "function_args": ["Channel", "Macro Channel", {"Ecommerce": "eCommerce", "Amazon": "eCommerce"}]
      },
      {
        "__function_comment__": "Whenever Channel is 'Facebook' or 'Other Social', set Macro Channel to 'Social'.",
        "function_name": "update_str_values_in_col2_based_on_col1_values",
        "function_args": ["Channel", "Macro Channel", {"Facebook": "Social", "Other Social": "Social"}]
      },
      {
        "__function_comment__": "Whenever Market is 'AA', 'Canada', 'US', 'USH', set Region to to 'North America'.",
        "function_name": "update_str_values_in_col2_based_on_col1_values",
        "function_args": ["Market", "Region",
          {"AA": "North America", "Canada": "North America", "US": "North America", "USH": "North America"}]
      },
      {
        "__function_comment__": "Whenever Category is 'pet', update Region to 'Hills'",
        "function_name": "update_str_values_in_col2_based_on_col1_values",
        "function_args": ["Category", "Region", {"pet": "Hills", "Pet": "Hills"}]
      },
      {
        "__function_comment__": "Whenever Segment Macro is 'pet food', update Region to 'Hills'",
        "function_name": "update_str_values_in_col2_based_on_col1_values",
        "function_args": ["Segment Macro", "Region", {"pet": "Hills", "Pet": "Hills"}]
      },
      {
        "__function_comment__": "After capitalizing words and updating values in/across columns, there must be no duplicates in essential columns.",
        "function_name": "check_possible_duplicates_in_multiple_columns",
        "function_args": [["Region", "Market", "Segment Macro", "Macro Channel", "Channel"]]
      },
      {
        "__function_comment__": "Create sum of budget rows for each region, year and macro channel pair/combination.",
        "function_name": "add_sum_of_budget_rows_for_each_region_year_and_macro_channel_pair",
        "function_args": [["Region", "Year", "Macro Channel"], "Budget (USD)"]
      },
      {
        "__function_comment__": "Because of the sorting order issue in Tableau, we need to add a space character in front of Region in total/sum Budget rows",
        "function_name": "add_char_in_front_of_region_names_in_total_rows",
        "function_args": [" "]
      },
      {
        "__function_comment__": "To show Division names in Market filter on Tableau, we need to copy Division (Region) names to Market column for 'Total' lines",
        "function_name": "copy_col1_value_to_col2_if_col2_has_specific_value",
        "function_args": ["Region", "Market", "Total"]
      },
      {
        "__function_comment__": "Capitalize Market names if they are the same as Division (Region) names (to look good on Tableau Market filter).",
        "function_name": "capitalize_market_name_if_they_are_the_same_as_region_name"
      },
      {
        "__function_comment__": "Whenever Market is ' AFRICA-EURASIA',' ASIA PACIFIC',' EUROPE',' HILLS',' LATIN AMERICA' or ' NORTH AMERICA', set Brand to ' All Brands'.",
        "function_name": "update_str_values_in_col2_if_col1_has_one_of_given_values",
        "function_args": [
          "Market",
          "Brand",
          [" AFRICA-EURASIA"," ASIA-PACIFIC"," EUROPE"," HILLS"," LATIN AMERICA"," NORTH AMERICA"],
          " All Brands"
        ]
      }
    ]
  }
]
